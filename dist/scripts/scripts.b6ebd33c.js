"use strict";angular.module("app",["ngRoute"]).config(["$locationProvider","$routeProvider",function(a,b){a.hashPrefix(""),b.when("/app",{templateUrl:"./views/questions.html",controller:"questionsController"}).when("/app/:id",{templateUrl:"./views/question.html",controller:"questionController"}).otherwise({redirectTo:"/app"})}]);var app=angular.module("app");app.controller("questionsController",["$scope","appAjaxService","$location",function(a,b,c){function d(a){a.votes=parseInt(a.upvotes)-parseInt(a.downvotes)}a.answers=b.getAnswerData(),a.questions=b.getQuestionsData(),0==a.questions.length&&b.getQuestionsAJAX().then(function(){a.questions=b.getQuestionsData(),b.getAnswersAJAX().then(function(){a.answers=b.getAnswerData()})}),a.upvote=function(a){a.upvotes++,d(a)},a.downvote=function(a){a.downvotes++,d(a)},a.openDetails=function(a){c.path("/app/"+a)}}]),app.controller("questionController",["$scope","appAjaxService","$location","$routeParams",function(a,b,c,d){function e(a,b){var c={};return a.forEach(function(a){a.Id===b&&(c=a)}),c}function f(a){a.votes=parseInt(a.upvotes)-parseInt(a.downvotes)}console.log(d),a.answers=b.getAnswerData(),a.question={};var g=b.getQuestionsData();g.length>0?a.question=e(g,d.id):b.getQuestionsAJAX().then(function(){a.question=e(b.getQuestionsData(),d.id),b.getAnswersAJAX().then(function(){a.answers=b.getAnswerData()})}),a.upvote=function(a){a.upvotes++,f(a)},a.downvote=function(a){a.downvotes++,f(a)}}]);var app=angular.module("app");app.filter("unsafe",["$sce",function(a){return a.trustAsHtml}]),app.filter("filterAnswerArray",function(){return function(a,b){var c=[];return a.forEach(function(a){a["Question-Id"]===b&&c.push(a)}),c}});var app=angular.module("app");app.service("appAjaxService",["$http","$q",function(a,b){function c(a){a.forEach(function(a){a.upvotes||(a.upvotes=0),a.downvotes||(a.downvotes=0),a.votes=parseInt(a.upvotes)-parseInt(a.downvotes)}),this.questions=a}function d(a){a.forEach(function(a){a.upvotes||(a.upvotes=0),a.downvotes||(a.downvotes=0),a.votes=parseInt(a.upvotes)-parseInt(a.downvotes)}),this.answers=a}this.questions=[],this.answers=[];var e=c.bind(this);this.getQuestionsAJAX=function(){var c=b.defer();return a.get("https://api.myjson.com/bins/dck5b").then(function(a){a.data&&Array.isArray(a.data.feed_questions)&&(e(a.data.feed_questions),c.resolve())},function(a){c.reject(a)}),c.promise};var f=d.bind(this);this.getAnswersAJAX=function(){var c=b.defer();return a.get("https://api.myjson.com/bins/hildr").then(function(a){a.data&&Array.isArray(a.data.feed_answers)&&(f(a.data.feed_answers),c.resolve())},function(a){c.reject(a)}),c.promise},this.getQuestionsData=function(){return this.questions},this.getAnswerData=function(){return this.answers}}]);